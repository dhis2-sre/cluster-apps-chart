# Default values for cluster-apps.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

ingress-nginx:
  controller:
    service:
      annotations:
        service.beta.kubernetes.io/aws-load-balancer-proxy-protocol: "*"
    config:
      use-proxy-protocol: true
      real-ip-header: proxy_protocol
    ingressClassResource:
      default: true
    metrics:
      enabled: true
      serviceMonitor:
        enabled: true
        additionalLabels:
          release: cluster-apps

cert-manager:
  installCRDs: true

cert-issuer-prod:
  email: andreas@dhis2.org
  server: https://acme-v02.api.letsencrypt.org/directory
  # Unsetting the ingressClass value, in order to use default ingress class.
  ingressClass: ""

kube-prometheus-stack:
  grafana:
    persistence:
      enabled: true
      size: 20Gi
      finalizers:
        - kubernetes.io/pvc-protection
    ingress:
      enabled: true
      hosts:
        - grafana.im.dhis2.org
      annotations:
        cert-manager.io/cluster-issuer: cert-issuer-prod
        ingress.kubernetes.io/ssl-redirect: "true"
      tls:
        - secretName: grafana-im-dhis2-org-tls
          hosts:
            - grafana.im.dhis2.org
    adminUser: admin
    adminPassword: # Leave empty for autogenerated password
    additionalDataSources:
      - name: Loki
        type: loki
        url: http://{{ .Release.Name }}-loki-querier:3100
  prometheus:
    prometheusSpec:
      podMonitorSelectorNilUsesHelmValues: false
      serviceMonitorSelectorNilUsesHelmValues: false
